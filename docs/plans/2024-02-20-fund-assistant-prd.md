# 基金投资助手 - 产品需求文档 (PRD)

**版本**: v1.0  
**创建日期**: 2024-02-20  
**状态**: 草案待评审

---

## 目录

1. [产品概述](#第一部分产品概述)
2. [核心功能模块](#第二部分核心功能模块)
3. [功能分期规划](#第三部分功能分期规划)
4. [技术架构设计](#第四部分技术架构设计)
5. [数据模型设计](#第五部分数据模型设计)
6. [界面原型要点](#第六部分界面原型要点)
7. [非功能需求](#第七部分非功能需求)
8. [风险评估与合规](#第八部分风险评估与合规)
9. [里程碑与验收标准](#第九部分里程碑与验收标准)
10. [附录](#第十部分附录)

---

## 第一部分：产品概述

### 1.1 产品定位

**基金投资助手**是一款面向普通散户投资者的Web应用，帮助用户集中管理分散在各平台的基金持仓，提供实时估值、盈亏分析和资产洞察。

### 1.2 核心价值

1. **持仓聚合**：统一管理蚂蚁财富、天天基金、银行渠道等多平台持仓
2. **实时估值**：交易日盘中实时估算基金净值和盈亏
3. **盈亏洞察**：可视化展示收益走势、资产配置和盈亏分析
4. **零门槛使用**：无需注册即可使用本地存储功能

### 1.3 目标用户画像

- 25-40岁普通上班族
- 在多个平台购买基金（蚂蚁、天天、银行等）
- 需要快速查看整体持仓状况
- 对基金分析有一定需求但非专业投资者

### 1.4 成功指标

| 指标 | 目标值 |
|------|--------|
| 月活跃用户（MAU） | 10,000+（发布后6个月） |
| 持仓导入成功率 | > 90% |
| 页面加载时间 | < 2秒 |
| 用户7日留存率 | > 30% |
| NPS评分 | > 50 |


---

## 第二部分：核心功能模块

### 2.1 资产总览页（首页）

**核心功能**：
- 顶部收益切换：昨日/持有/累计三维度快速切换
- 收益走势图：多时间维度切换，支持基准对比
- 资产配置环形图：直观展示资产分布
- 收益日历：热力图展示每日收益情况
- 关键指标卡片：年化收益、最大回撤、夏普比率
- 持仓列表：卡片式展示，含实时估值

### 2.2 基金详情页

**功能模块**：
- 基金经理信息：照片、简介、历史业绩
- 持仓明细：资产配置、行业分布、前十大重仓股
- 风险评估：波动率、夏普比率、最大回撤

### 2.3 收益分析中心

**多维度收益分析**：
1. **时间维度**：日收益明细、周收益汇总、月度收益柱状图、年度收益对比
2. **基金维度**：收益贡献TOP5、亏损TOP5
3. **类型维度**：股票/债券/混合/货币型基金收益分布
4. **渠道维度**：各购买渠道收益对比

**高级分析指标**：
- 年化收益率（XIRR计算）
- 与沪深300的超额收益对比
- 胜率统计（盈利天数占比）
- 盈亏比（平均盈利/平均亏损）

### 2.4 市场发现页

**市场行情**：
- 大盘指数实时行情（沪深300、创业板指等）
- 行业涨跌分布热力图
- 资金流向分析

**基金排行与筛选**：
- 热销榜、能涨抗跌榜、定投人气榜
- 多维度筛选器：类型/风险/业绩/规模/标签
- 智能标签：金选、金牛奖、晨星五星、科技成长、低波动

### 2.5 基金对比功能

支持最多5只基金同时对比：
- 业绩走势对比（多线折线图）
- 风险指标对比（雷达图/表格）
- 持仓对比（行业分布、重仓股）
- 费率对比

### 2.6 交易管理功能

**买入功能**：
- 基金搜索与选择
- 买入金额输入（最低10元起）
- 费率计算展示
- 确认页面预览

**卖出功能**：
- 持仓列表展示
- 可卖份额显示
- 部分/全部卖出选择
- 赎回费率计算

**定投管理**：
- 定投计划创建（金额/周期/日期）
- 定投计划管理（暂停/恢复/终止）
- 定投收益统计
- 定投计算器（收益预测）

### 2.7 消息与提醒中心

**消息类型**：
- 净值更新提醒（每日净值公布后）
- 大涨大跌提醒（单日涨跌超过设定阈值）
- 定投扣款提醒（扣款前1日通知）
- 季报/年报发布提醒
- 基金经理变更提醒

### 2.8 个人中心与设置

**账户管理**：
- 登录/注册（微信扫码/手机号）
- 数据同步设置
- 云端备份与恢复

**数据管理**：
- 持仓导入（手动/Excel/截图）
- 数据导出（Excel/JSON）
- 清空本地数据

**显示设置**：
- 主题切换（浅色/深色模式）
- 默认时间维度
- 首页模块配置（拖拽排序）


---

## 第三部分：功能分期规划

### MVP版本（4周）- 核心闭环

**目标**：实现持仓导入、实时估值、基础盈亏展示的核心闭环，验证用户需求

| 模块 | 功能点 | 优先级 |
|------|--------|--------|
| **持仓导入** | 手动录入基金持仓 | P0 |
| | Excel模板导入 | P0 |
| **实时估值** | 交易日盘中估值刷新 | P0 |
| | 单只基金估值展示 | P0 |
| | 总资产估值汇总 | P0 |
| **资产总览** | 顶部收益卡片 | P0 |
| | 收益走势图 | P0 |
| | 持仓基金列表 | P0 |
| **基金详情** | 基础信息展示 | P0 |
| | 净值走势图 | P0 |
| **数据存储** | 本地IndexedDB存储 | P0 |

**验收标准**：
- [ ] 支持手动录入和Excel导入持仓
- [ ] 交易日实时估值正常显示
- [ ] 收益走势图可正常展示
- [ ] 页面加载时间 < 3秒
- [ ] 移动端适配正常

### 一期版本（+4周）- 深度分析

**目标**：增加收益分析和资产配置功能，提升用户粘性

| 模块 | 功能点 | 优先级 |
|------|--------|--------|
| **收益分析** | 月度收益柱状图 | P1 |
| | 基金盈亏排行 | P1 |
| | 收益日历热力图 | P1 |
| | 关键指标计算 | P1 |
| **资产配置** | 资产类型分布饼图 | P1 |
| | 风险等级分布 | P2 |
| **基金详情增强** | 持仓明细展示 | P1 |
| | 风险评估指标 | P2 |
| **交易功能** | 买入记录管理 | P1 |
| | 卖出记录管理 | P1 |
| **云端同步** | 用户登录/注册 | P1 |
| | 云端数据同步 | P1 |

### 二期版本（+6周）- 智能发现

**目标**：增加市场发现、基金对比、定投管理功能，提升活跃度

| 模块 | 功能点 | 优先级 |
|------|--------|--------|
| **市场发现** | 大盘指数行情 | P2 |
| | 基金排行榜 | P2 |
| | 基金筛选器 | P2 |
| **基金对比** | 多基金对比(最多5只) | P2 |
| | 风险指标对比 | P2 |
| **定投管理** | 定投计划创建 | P2 |
| | 定投管理列表 | P2 |
| | 定投计算器 | P2 |
| **消息中心** | 净值更新提醒 | P2 |
| | 大涨大跌提醒 | P2 |

### 三期版本（+8周）- 智能生态

**目标**：引入AI能力、社区功能，打造投资生态圈

| 模块 | 功能点 | 优先级 |
|------|--------|--------|
| **智能助理** | 基金诊断 | P3 |
| | 市场解读 | P3 |
| | 持仓建议 | P3 |
| **社区功能** | 基金讨论区 | P3 |
| | 热门话题 | P3 |
| **高级功能** | 组合回测 | P3 |
| | 风险预警 | P3 |


---

## 第四部分：技术架构设计

### 4.1 系统架构

```
前端层 (Next.js)
  - 资产总览页、基金详情页、市场发现页、个人中心
  - 技术栈: React + TypeScript + TailwindCSS + ECharts

API 网关层
  - Next.js API Routes

服务层
  - 基金数据服务 (估值/详情)
  - 用户服务 (认证/同步)
  - 分析服务 (计算/报表)

数据层
  - PostgreSQL (云端数据)
  - Redis (缓存)
  - IndexedDB (本地存储)

外部数据源
  - 天天基金API (主数据源)
  - 东方财富API (备用扩展)
```

### 4.2 关键技术选型

| 层级 | 技术选型 | 理由 |
|------|----------|------|
| **前端框架** | Next.js 14 (App Router) | SSR支持、SEO友好、生态成熟 |
| **UI组件库** | TailwindCSS + Headless UI | 高度可定制、性能好 |
| **图表库** | ECharts / Victory | 功能丰富、交互性强 |
| **状态管理** | Zustand + React Query | 轻量、TypeScript友好 |
| **后端API** | Next.js API Routes | 一体化开发、部署简单 |
| **数据库** | PostgreSQL (云端) | 关系型数据、扩展性好 |
| **缓存** | Redis / Upstash | 实时估值缓存、限流 |
| **本地存储** | IndexedDB (Dexie.js) | 大容量、结构化查询 |
| **认证** | NextAuth.js | 支持微信/手机号登录 |
| **部署** | Vercel | 一键部署、全球CDN |

---

## 第五部分：数据模型设计

### 5.1 核心数据模型

#### Fund（基金信息）
```typescript
interface Fund {
  id: string;                    // 基金代码
  name: string;                  // 基金名称
  type: FundType;                // 基金类型
  riskLevel: RiskLevel;          // 风险等级
  company: string;               // 基金公司
  managerId: string;             // 基金经理ID
  nav: number;                   // 最新单位净值
  accumNav: number;              // 累计净值
  navDate: string;               // 净值日期
  estimateNav?: number;          // 估算净值（实时）
  estimateTime?: string;         // 估算时间
  feeRate: {
    buy: number;                 // 申购费率
    sell: number;                // 赎回费率
    management: number;          // 管理费率
  };
  createdAt: Date;
  updatedAt: Date;
}
```

#### Holding（持仓）
```typescript
interface Holding {
  id: string;                    // 唯一ID
  userId: string;                // 用户ID
  fundId: string;                // 基金代码
  fundName: string;              // 基金名称
  totalShares: number;           // 总份额
  avgCost: number;               // 平均成本价
  totalAmount: number;           // 持仓总金额
  group?: string;                // 分组名称
  tags?: string[];               // 自定义标签
  channel?: string;              // 购买渠道
  createdAt: Date;
  updatedAt: Date;
  version: number;               // 数据版本
}
```

#### Transaction（交易记录）
```typescript
interface Transaction {
  id: string;
  holdingId: string;
  fundId: string;
  type: TransactionType;         // BUY | SELL | DIVIDEND
  date: string;
  shares: number;
  price: number;
  amount: number;
  fee: number;
  notes?: string;
  createdAt: Date;
}
```

### 5.2 本地存储结构

```typescript
// Dexie.js 数据库定义
class FundDatabase extends Dexie {
  funds!: Table<Fund>;
  holdings!: Table<Holding>;
  transactions!: Table<Transaction>;
  settings!: Table<AppSettings>;
  
  constructor() {
    super('FundAssistant');
    this.version(1).stores({
      funds: 'id, type, company',
      holdings: 'id, fundId, group',
      transactions: 'id, holdingId, fundId, date',
      settings: 'key'
    });
  }
}
```


---

## 第六部分：界面原型要点

### 6.1 设计原则

1. **简洁直观**：首屏展示核心数据，减少认知负担
2. **数据可视化**：用图表替代表格，一眼看懂趋势
3. **移动端优先**：单手操作友好，重要按钮在底部
4. **色彩规范**：
   - 上涨：#F56C6C（红色）
   - 下跌：#67C23A（绿色）
   - 主色调：#409EFF（蓝色）
   - 背景：#F5F7FA（浅灰）

### 6.2 响应式设计断点

| 设备类型 | 断点 | 布局特点 |
|---------|------|----------|
| **手机竖屏** | < 640px | 单列布局，底部固定导航 |
| **手机横屏/平板** | 640px - 1024px | 双列布局，侧边导航 |
| **桌面端** | > 1024px | 三列布局，最大宽度1200px居中 |

### 6.3 交互设计规范

**手势操作**：
- 左滑：删除持仓（需确认）
- 下拉：刷新数据
- 长按：弹出操作菜单

**动画效果**：
- 页面切换：300ms淡入淡出
- 数字变化：数字滚动动画
- 图表加载：渐显动画

---

## 第七部分：非功能需求

### 7.1 性能要求

| 指标 | 目标值 |
|------|--------|
| **首屏加载时间** | < 2秒（3G网络环境下） |
| **API响应时间** | < 500ms（P95分位值） |
| **页面切换时间** | < 300ms |
| **实时估值刷新** | 30秒间隔（交易日9:30-15:00） |
| **并发用户数** | 1000+ |

### 7.2 安全要求

| 安全措施 | 实施方案 |
|---------|----------|
| **数据传输** | HTTPS全站加密 |
| **数据存储** | 敏感字段加密（AES-256） |
| **接口安全** | Rate Limiting（60次/分钟/IP） |
| **认证安全** | JWT Token + Refresh Token机制 |
| **输入校验** | 前端+后端双重校验，防SQL注入/XSS |

### 7.3 可用性要求

- **可用性目标**：99.9%（年停机时间 < 8.76小时）
- **故障恢复**：RTO < 30分钟，RPO < 5分钟
- **降级策略**：数据源故障时展示缓存数据并提示用户


---

## 第八部分：风险评估与合规

### 8.1 合规要求

**基金信息展示合规**：
- 明确标注"估值数据仅供参考，以基金公司披露为准"
- 不承诺收益，不预测未来业绩
- 风险等级与基金实际评级一致
- 费率信息准确展示

**用户数据处理**：
- 遵守《个人信息保护法》
- 用户可导出/删除个人数据
- 隐私政策明确告知数据用途
- 不存储用户交易密码等敏感信息

### 8.2 风险提示文案

**估值页面常驻提示**：
> "本页面展示的基金估值数据仅供参考，实际净值以基金公司官方披露为准。基金投资有风险，过往业绩不代表未来表现。"

**首次使用提示**：
> "欢迎使用基金投资助手！本应用仅提供持仓管理和数据分析功能，不构成投资建议。市场有风险，投资需谨慎。"

### 8.3 数据源风险

| 风险点 | 影响 | 缓解措施 |
|--------|------|---------|
| 天天基金API限流 | 估值数据获取失败 | 缓存机制 + 错误降级 |
| API接口变更 | 数据解析失败 | 监控告警 + 快速修复 |
| 数据源停止服务 | 无法获取估值 | 预留多数据源扩展接口 |

---

## 第九部分：里程碑与验收标准

### 9.1 项目里程碑

```
Week 1-2:  [需求细化] 完成PRD评审 + 技术方案设计
Week 3-4:  [MVP开发] 完成核心功能开发
Week 5:    [MVP测试] 内部测试 + Bug修复
Week 6:    [MVP发布] 内测上线，收集用户反馈
Week 7-10: [一期开发] 深度分析功能开发
Week 11:   [一期发布] 正式对外发布
Week 12-17:[二期开发] 智能发现功能开发
Week 18:   [二期发布] 功能全面上线
```

### 9.2 MVP验收标准

**功能验收**：
- [ ] 支持手动录入和Excel导入持仓
- [ ] 交易日实时估值正常显示
- [ ] 收益走势图可正常展示
- [ ] 交易记录管理可用
- [ ] 云端同步功能稳定

**性能验收**：
- [ ] 首屏加载时间 < 2秒
- [ ] 页面切换流畅，无卡顿
- [ ] 实时估值刷新无闪烁

**体验验收**：
- [ ] 移动端适配良好
- [ ] 深色模式切换正常
- [ ] 5位测试用户完成持仓导入无阻碍

### 9.3 成功指标（OKR）

**Objective：打造最受欢迎的散户基金持仓管理工具**

| Key Result | 目标值 | 考核周期 |
|-----------|--------|---------|
| 月活跃用户（MAU） | 10,000+ | 发布后6个月 |
| 持仓导入成功率 | > 90% | 持续监控 |
| 用户7日留存率 | > 30% | 持续监控 |
| NPS评分 | > 50 | 季度调研 |
| 平均使用时长 | > 5分钟/次 | 持续监控 |


---

## 第十部分：附录

### 附录A：基金类型定义

| 类型代码 | 名称 | 说明 |
|---------|------|------|
| `STOCK` | 股票型 | 股票仓位≥80%，高风险高收益 |
| `BOND` | 债券型 | 债券仓位≥80%，稳健收益 |
| `MIX` | 混合型 | 股债灵活配置，中等风险 |
| `INDEX` | 指数型 | 跟踪特定指数，被动管理 |
| `QDII` | QDII | 投资海外市场 |
| `FOF` | FOF | 投资基金的基金 |
| `MONEY` | 货币型 | 货币市场工具，低风险 |

### 附录B：风险等级定义

| 等级 | 代码 | 描述 | 适合人群 |
|------|------|------|---------|
| 低风险 | `LOW` | 本金损失概率极低 | 保守型投资者 |
| 中低风险 | `LOW_MEDIUM` | 本金损失概率较低 | 稳健型投资者 |
| 中等风险 | `MEDIUM` | 存在一定波动 | 平衡型投资者 |
| 中高风险 | `MEDIUM_HIGH` | 波动较大 | 进取型投资者 |
| 高风险 | `HIGH` | 可能大幅亏损 | 激进型投资者 |

### 附录C：Excel导入模板

**模板字段说明**：

| 字段 | 必填 | 格式 | 示例 |
|------|------|------|------|
| 基金代码 | 是 | 6位数字 | 519674 |
| 基金名称 | 否 | 文本 | 银河创新成长混合A |
| 持仓份额 | 是 | 数字 | 1000.00 |
| 持仓成本 | 是 | 数字（4位小数） | 5.2345 |
| 买入日期 | 否 | YYYY-MM-DD | 2024-01-15 |
| 买入渠道 | 否 | 文本 | 蚂蚁财富 |
| 分组 | 否 | 文本 | 核心持仓 |
| 标签 | 否 | 逗号分隔 | 科技,成长 |

**CSV模板示例**：
```csv
基金代码,基金名称,持仓份额,持仓成本,买入日期,买入渠道,分组,标签
519674,银河创新成长混合A,1000,5.2345,2024-01-15,蚂蚁财富,核心持仓,科技,成长
000001,华夏成长混合,2000,3.1234,2024-02-01,天天基金,卫星持仓,稳健
```

### 附录D：API接口清单（MVP）

| 接口 | 方法 | 描述 |
|------|------|------|
| `/api/funds/search` | GET | 搜索基金（代码/名称） |
| `/api/funds/:code` | GET | 获取基金详情 |
| `/api/funds/estimates` | POST | 批量获取基金实时估值 |
| `/api/holdings` | GET/POST/PUT/DELETE | 持仓CRUD |
| `/api/holdings/import` | POST | Excel导入持仓 |
| `/api/transactions` | GET/POST | 交易记录管理 |
| `/api/user/sync` | POST | 数据同步 |
| `/api/auth/login` | POST | 用户登录 |
| `/api/auth/logout` | POST | 用户登出 |

### 附录E：术语表

| 术语 | 说明 |
|------|------|
| **NAV** | Net Asset Value，基金单位净值 |
| **累计净值** | 包含分红再投资的净值 |
| **估算净值** | 交易日盘中根据持仓股票实时估算的净值 |
| **夏普比率** | 风险调整后收益指标，越高越好 |
| **最大回撤** | 从高点到低点的最大跌幅 |
| **XIRR** | 扩展内部收益率，考虑时间价值的年化收益 |
| **定投** | 定期定额投资基金 |
| **持仓成本** | 买入基金的平均价格 |

---

## 文档信息

| 项目 | 内容 |
|------|------|
| **文档名称** | 基金投资助手产品需求文档（PRD） |
| **版本号** | v1.0 |
| **创建日期** | 2024-02-20 |
| **最后更新** | 2024-02-20 |
| **作者** | 产品团队 |
| **状态** | 草案待评审 |

### 变更记录

| 版本 | 日期 | 变更内容 | 作者 |
|------|------|---------|------|
| v0.1 | 2024-02-20 | 初稿创建，完成核心功能规划 | - |
| v1.0 | 2024-02-20 | 完善功能分期、技术架构、数据模型 | - |

---

**PRD文档已完成！**

本文档涵盖了：
- 产品概述与定位
- 详细功能模块（对标蚂蚁财富）
- 功能分期规划（MVP/一期/二期/三期）
- 技术架构设计
- 数据模型设计
- 界面原型要点
- 非功能需求
- 合规与风险评估
- 里程碑与验收标准
- 附录（模板、术语等）
